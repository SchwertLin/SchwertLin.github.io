<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Schwertlilien"/><meta name="keyword"/><meta name="description" content="å®éªŒè¯´æ˜æ•°æ® metadata: new_metadata.csv HSI åŸå§‹æ–‡ä»¶ç›®å½•ï¼š processed_npy&#x2F; æœ‰æ•ˆæ ·æœ¬æ•°ï¼ˆè¿‡æ»¤äº†æ— æ•ˆ toxin_valueï¼‰: 200 æ ·æœ¬   å€¼å¾—è¯´æ˜çš„æ˜¯ï¼šæ­¤å¤„çš„æ ·æœ¬æ•°é‡æ˜¯å› ä¸ºå†…å­˜ç©ºé—´ä¸è¶³ï¼Œå¯¼è‡´ç›®å‰ä»…èƒ½è¿è¡Œ200æ ·æœ¬ã€‚æ˜¨å¤©å·²å¯¹æœåŠ¡å™¨ç©ºé—´è¿›è¡Œæ•´ç†ï¼Œåç»­å¯ä»¥ç”¨å…¨éƒ¨æ ·æœ¬è¿›è¡Œæµ‹é‡ã€‚   HSI åŸå§‹ç©ºé—´å°ºå¯¸ï¼šå¤šä¸º 960Ã—960ï¼ˆé¢„å¤„ç†ä¼š resize åˆ°">
<meta property="og:type" content="article">
<meta property="og:title" content="Thu Oct 30 2025 00:00:00 GMT+0800 (ä¸­åœ‹æ¨™æº–æ™‚é–“)">
<meta property="og:url" content="http://example.com/2025/10/30/2025-10-28/index.html">
<meta property="og:site_name" content="Schwertlilien">
<meta property="og:description" content="å®éªŒè¯´æ˜æ•°æ® metadata: new_metadata.csv HSI åŸå§‹æ–‡ä»¶ç›®å½•ï¼š processed_npy&#x2F; æœ‰æ•ˆæ ·æœ¬æ•°ï¼ˆè¿‡æ»¤äº†æ— æ•ˆ toxin_valueï¼‰: 200 æ ·æœ¬   å€¼å¾—è¯´æ˜çš„æ˜¯ï¼šæ­¤å¤„çš„æ ·æœ¬æ•°é‡æ˜¯å› ä¸ºå†…å­˜ç©ºé—´ä¸è¶³ï¼Œå¯¼è‡´ç›®å‰ä»…èƒ½è¿è¡Œ200æ ·æœ¬ã€‚æ˜¨å¤©å·²å¯¹æœåŠ¡å™¨ç©ºé—´è¿›è¡Œæ•´ç†ï¼Œåç»­å¯ä»¥ç”¨å…¨éƒ¨æ ·æœ¬è¿›è¡Œæµ‹é‡ã€‚   HSI åŸå§‹ç©ºé—´å°ºå¯¸ï¼šå¤šä¸º 960Ã—960ï¼ˆé¢„å¤„ç†ä¼š resize åˆ°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgFigure_1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgimage-20251102001925441.png">
<meta property="og:image" content="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgimage-20251106114412890.png">
<meta property="article:published_time" content="2025-10-30T01:54:34.000Z">
<meta property="article:modified_time" content="2025-11-13T07:10:29.775Z">
<meta property="article:author" content="Schwertlilien">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgFigure_1.png"><title>Thu Oct 30 2025 00:00:00 GMT+0800 (ä¸­åœ‹æ¨™æº–æ™‚é–“) - Schwertlilien - -----personal blog-----</title><link rel="shortcut icon" href="/img/site-icon.png">
<link rel="stylesheet" href="/css/style.css" id="dm-light">


<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
<meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="top-nav" ondblclick="scrollToTop()"><div class="nav-info"><div class="nav-icon"><img id="nav-icon" src="/img/site-icon.png"/></div><div class="nav-title"><a id="nav-title" href="/" title="ä¸»é¡µ">Schwertlilien</a></div></div><div class="nav-ribbon"><div class="top-menu-expanded"><a class="top-menu-item" href="/archives"><span>å½’æ¡£</span></a><a class="top-menu-item" href="/categories"><span>åˆ†ç±»</span></a><a class="top-menu-item" href="/tags"><span>æ ‡ç­¾</span></a><a class="top-menu-item" href="/about"><span>å…³äº</span></a></div><div class="top-search" onclick="toggleSearchWindow()"><div id="top-search-btn" title="æœç´¢"><i class="icon fa-solid fa-magnifying-glass"></i><span>æœç´¢</span></div></div><div id="top-menu-btn" onclick="openTopMenu()" title="æ‰“å¼€èœå•"><i class="fa-solid fa-bars fa-lg"></i></div></div></div></header><div id="top-menu-hidden"><div class="menu-hidden-content"><div class="menu-hidden-nav"><a class="menu-hidden-item" href="/archives"><i class="fa-solid fa-box-archive fa-sm"></i><span>å½’æ¡£</span></a><a class="menu-hidden-item" href="/categories"><i class="fa-regular fa-folder-open fa-sm"></i><span>åˆ†ç±»</span></a><a class="menu-hidden-item" href="/tags"><i class="fa-solid fa-tags fa-sm"></i><span>æ ‡ç­¾</span></a><a class="menu-hidden-item" href="/about"><i class="fa-solid fa-paw fa-sm"></i><span>å…³äº</span></a></div></div><div class="menu-hidden-blank" onclick="closeTopMenu()"></div></div>
<div class="blog-info"><div class="blog-pic"><img id="blog-pic" src="/img/site-icon.png"/></div><div class="blog-title"><i class="fa-solid fa-paw fa-2xs fa-rotate-by"></i><span>Schwertlilien</span><i class="fa-solid fa-paw fa-2xs fa-rotate-by"></i></div><div class="blog-desc">As a recoder: notes and ideas.</div></div><div class="main"><div class="main-content"><article class="post"><div class="post-title"><h1><i class="fa-solid fa-paw"></i>Thu Oct 30 2025 00:00:00 GMT+0800 (ä¸­åœ‹æ¨™æº–æ™‚é–“)</h1></div><div class="post-info"><div class="post-info-first-line"><div class="post-date"><i class="icon fa-regular fa-calendar-plus" title="å‘å¸ƒæ—¥æœŸ"></i><time class="publish-time">2025-10-30</time><i class="icon fa-regular fa-calendar-check" title="æ›´æ–°æ—¥æœŸ"></i><time class="update-time">2025-11-13</time></div>

</div><div class="post-info-second-line"><div class="post-copyright"><i class="icon fa-brands fa-creative-commons" title="ç‰ˆæƒå£°æ˜"></i><span>ç‰ˆæƒå£°æ˜: </span><a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh-hans" title="CC BY-NC-ND 4.0">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0</a></div>
<div class="post-word-count"><i class="icon fa-solid fa-pen-to-square"></i><span>å…¨æ–‡çº¦1.8Kå­—</span></div><div class="pageview-post"><i class="icon fa-regular fa-eye"></i><span id="busuanzi_container_page_pv">é˜…è¯»æ¬¡æ•°: <span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner"></i></span></span></div></div></div><div class="post-content"><h1 id="å®éªŒè¯´æ˜"><a href="#å®éªŒè¯´æ˜" class="headerlink" title="å®éªŒè¯´æ˜"></a>å®éªŒè¯´æ˜</h1><h2 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h2><ul>
<li>metadata: new_metadata.csv</li>
<li>HSI åŸå§‹æ–‡ä»¶ç›®å½•ï¼š processed_npy/</li>
<li>æœ‰æ•ˆæ ·æœ¬æ•°ï¼ˆè¿‡æ»¤äº†æ— æ•ˆ toxin_valueï¼‰: <strong>200 æ ·æœ¬</strong></li>
</ul>
<blockquote>
<p><strong>å€¼å¾—è¯´æ˜çš„æ˜¯ï¼š</strong>æ­¤å¤„çš„æ ·æœ¬æ•°é‡æ˜¯å› ä¸ºå†…å­˜ç©ºé—´ä¸è¶³ï¼Œå¯¼è‡´ç›®å‰ä»…èƒ½è¿è¡Œ200æ ·æœ¬ã€‚æ˜¨å¤©å·²å¯¹æœåŠ¡å™¨ç©ºé—´è¿›è¡Œæ•´ç†ï¼Œåç»­å¯ä»¥ç”¨å…¨éƒ¨æ ·æœ¬è¿›è¡Œæµ‹é‡ã€‚</p>
</blockquote>
<ul>
<li>HSI åŸå§‹ç©ºé—´å°ºå¯¸ï¼šå¤šä¸º 960Ã—960ï¼ˆé¢„å¤„ç†ä¼š resize åˆ° target_sizeï¼‰</li>
<li>ç›®æ ‡å°ºå¯¸ï¼š256Ã—256</li>
<li>CBAM æ£€æµ‹åˆ°çš„ common spectral channels: 600ï¼ˆpreprocess_data è¾“å‡ºï¼‰ï¼›å®é™…ç”¨äºè®­ç»ƒæ—¶ç”± loader è¿”å›çš„ channels = detected_input_channelsï¼ˆæœ¬å®éªŒè‡ªåŠ¨ä½¿ç”¨è¯¥å€¼æ„é€ æ¨¡å‹ï¼‰</li>
<li>æ³¨æ„ï¼šéƒ¨åˆ† .npy æ–‡ä»¶å­˜åœ¨ header/å¤§å°ä¸ä¸€è‡´ï¼ˆç¤ºä¾‹ï¼š6-22.npyï¼‰ï¼Œå·²åœ¨ loader ä¸­åšå®¹é”™ï¼ˆè®°å½• bad_npy.logï¼Œå¹¶åœ¨å¿…è¦æ—¶å¡«å……/è£å‰ªï¼‰</li>
</ul>
<h2 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h2><p>å·²ç»Ÿä¸€å¹¶å¤ç”¨ <code>CBAM_model.py</code> çš„é¢„å¤„ç†æµç¨‹ï¼ˆpreprocess_dataï¼‰ï¼š</p>
<ul>
<li>HSI:<ul>
<li>resize -&gt; target_size (256Ã—256)</li>
<li>ç»Ÿä¸€é€šé“æ•°æ¨æ–­/é‡é‡‡æ ·ï¼ˆä½¿ç”¨ CBAM çš„ channel inference / resample é€»è¾‘ï¼‰</li>
<li>å…¨å±€ per-channel mean/std è®¡ç®—å¹¶åº”ç”¨ï¼ˆZ-score æ ‡å‡†åŒ–ï¼‰ â€” è¿™ä¿è¯ Fusion ä¸ CBAM åœ¨ HSI æ•°å€¼å°ºåº¦ä¸Šä¸€è‡´</li>
</ul>
</li>
<li>Fluor (Value_Raw):<ul>
<li>è®¡ç®—å¹¶è®°å½• mean/stdï¼Œtraining æ—¶å¯åšæ ‡å‡†åŒ–ï¼ˆpreprocess_data å·²è®¡ç®—å¹¶å¯è¿”å› scalerï¼‰</li>
</ul>
</li>
<li>Toxin label:<ul>
<li>è®¡ç®—å¹¶ç¼“å­˜ MinMax (æˆ–å…¶ä»–) scalerï¼ˆpreprocess_data è¾“å‡º label_scalerï¼‰</li>
</ul>
</li>
<li>RGB:<ul>
<li>é€šè¿‡ metadata å°è¯•å®šä½å¹¶è¯»å–å›¾åƒï¼ˆè‹¥æ‰¾ä¸åˆ°ï¼Œè¿”å›å…¨é›¶å¼ é‡ï¼‰ï¼›å›¾åƒè¢« resize åˆ° target_size å¹¶ ToTensor()</li>
</ul>
</li>
</ul>
<h2 id="æ¨¡å‹"><a href="#æ¨¡å‹" class="headerlink" title="æ¨¡å‹"></a>æ¨¡å‹</h2><p>é€‰ç”¨äº†ä¸åŒçš„encoderå¯¹å„ä¸ªæ¨¡æ€çš„æ•°æ®æå–ç‰¹å¾ä¹‹åï¼Œè¿›è¡Œç‰¹å¾èåˆã€‚æ­¤å¤„é€‰æ‹©äº†æ™šæœŸèåˆçš„å››ç§æ–¹å¼ã€‚</p>
<ol>
<li><strong>CBAMFusion</strong>: HSI ç”¨ CBAM å·ç§¯è·¯å¾„ï¼ŒRGB ç”¨ ResNet18ï¼ˆfc æ›¿æ¢ï¼‰ï¼ŒFluor ç”¨å° MLPï¼Œlate fusionï¼ˆconcat -&gt; fcï¼‰</li>
<li><strong>SimpleFusion</strong>: ç®€å• late fusionï¼ˆHSI-CNN + ResNet18 + Fluor-MLP -&gt; concat -&gt; classifierï¼‰</li>
<li><strong>AttentionFusion</strong>: 3 æ¨¡æ€ç‰¹å¾åç”¨å°æ³¨æ„åŠ›ç½‘ç»œå­¦ä¹ åŠ æƒèåˆ</li>
<li><strong>WeightedLateFusion</strong>: å¯å­¦ä¹ çš„æ¨¡æ€æƒé‡ï¼ˆå‚æ•°åŒ–å‘é‡ -&gt; softmaxï¼‰</li>
</ol>
<h2 id="å®éªŒé…ç½®"><a href="#å®éªŒé…ç½®" class="headerlink" title="å®éªŒé…ç½®"></a>å®éªŒé…ç½®</h2><p>è®­ç»ƒ/éªŒè¯åˆ’åˆ†ï¼šç”± preprocess_data è¿”å›ï¼ˆä½¿ç”¨å…¶é»˜è®¤åˆ’åˆ†ç­–ç•¥ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">metadata_csv = <span class="string">&quot;/Users/.../processed_npy/new_metadata.csv&quot;</span></span><br><span class="line">npy_root = <span class="string">&quot;/Users/.../processed_npy&quot;</span></span><br><span class="line">batch_size = <span class="number">8</span></span><br><span class="line">num_epochs = <span class="number">50</span></span><br><span class="line">device = cpu (è‹¥ GPU å¯ç”¨åˆ™è‡ªåŠ¨ä½¿ç”¨ cuda)</span><br><span class="line">target_spectral_channels: <span class="number">30</span> ï¼ˆè„šæœ¬ä¸­è®¾ç½®ï¼Œä½†å®é™…ä½¿ç”¨ detected channelsï¼‰</span><br><span class="line">target_size = (<span class="number">256</span>, <span class="number">256</span>)</span><br><span class="line">optimizer = AdamW(model.parameters(), lr=<span class="number">1e-4</span>, weight_decay=<span class="number">1e-5</span>)</span><br><span class="line">loss = MSELoss()</span><br><span class="line">grad clipping: clip_grad_norm_ max_norm = <span class="number">1.0</span></span><br><span class="line">hidden_dim = <span class="number">128</span></span><br><span class="line">ResNet backbone: pretrained ResNet18 (weights handled <span class="keyword">with</span> torchvision API compatibility)</span><br></pre></td></tr></table></figure>
<h2 id="å®éªŒè¿è¡Œç»“æœ"><a href="#å®éªŒè¿è¡Œç»“æœ" class="headerlink" title="å®éªŒè¿è¡Œç»“æœ"></a>å®éªŒè¿è¡Œç»“æœ</h2><p>è¯„ä¼°æŒ‡æ ‡é€‰ç”¨ï¼šMAEã€RMSEã€RÂ²</p>
<ul>
<li><p>è®­ç»ƒæ—¶é•¿ï¼š450minï¼ˆä¾‹å¦‚ï¼šæ¯ epoch å¹³å‡ 3 åˆ†é’Ÿï¼‰</p>
</li>
<li><p>æœ€ä½³éªŒè¯ loss (MSE): 0.0006</p>
<p>CBAMFusion      | MAE: 4.0241 | RÂ²: 0.9961 | RMSE: 4.6529<br>SimpleFusion    | MAE: 3.5551 | RÂ²: 0.9969 | RMSE: 4.1378<br>AttentionFusion | MAE: 2.7030 | RÂ²: 0.9978 | RMSE: 3.4530<br>WeightedFusion  | MAE: 3.2109 | RÂ²: 0.9970 | RMSE: 4.0845</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgFigure_1.png" alt="Figure_1"></p>
<p>æˆ‘ç°åœ¨éœ€è¦åšä¸€ä¸ªæ¶ˆèå®éªŒï¼Œä¹Ÿå°±æ˜¯å¯¹ä¸‰ç§æ¨¡æ€çš„æ•°æ®æ£€æµ‹ï¼šé«˜å…‰è°±ï¼Œrgbï¼Œè§å…‰å€¼åˆ†åˆ«å•ç‹¬è¾“å…¥æ¨¡å‹å¾—åˆ°çš„ç»“æœï¼Œä»ä¸‰ä¸ªæ¨¡æ€ä¸­é€‰ä¸¤ä¸ªå¾—åˆ°çš„ç»“æœï¼Œä»¥åŠä¸‰ä¸ªæ¨¡æ€å…¨ç”¨å¾—åˆ°çš„è®­ç»ƒç»“æœã€‚</p>
<p>CBAMFusion      | MAE: 3.5327 | RÂ²: 0.9967 | RMSE: 4.2312<br>SimpleFusion    | MAE: 3.6707 | RÂ²: 0.9966 | RMSE: 4.3289<br>AttentionFusion | MAE: 2.5240 | RÂ²: 0.9981 | RMSE: 3.2732<br>WeightedFusion  | MAE: 2.9873 | RÂ²: 0.9973 | RMSE: 3.8291</p>
<p><img src="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgimage-20251102001925441.png" alt="image-20251102001925441"></p>
<p>æ‰¾</p>
<p>æˆ‘çš„æ•°æ®é›†æ˜¯å…·æœ‰ä¸‰æ¨¡æ€çš„æ•°æ®é«˜å…‰è°±.spe+.hdrï¼Œè§å…‰å€¼ï¼ˆæ ‡é‡ï¼‰ï¼Œä»¥åŠåŸå§‹rgbå›¾åƒ.bmp.å‡å¦‚è¯´æˆ‘æƒ³æŒ‰ç…§æˆ‘çš„æ•°æ®é›†æ¥åŠ è½½å…¥è¿™ä¸ªI2MoEçš„æ–¹æ³•ï¼Œç”¨I2MoEçš„æ–¹æ³•åœ¨æˆ‘çš„æ•°æ®é›†ä¸Šè®­ç»ƒå¾—åˆ°å›å½’æ•°å€¼çš„ç»“æœã€‚é‚£ä¹ˆæˆ‘é¦–å…ˆéœ€è¦åœ¨/Users/schwertlilien/Downloads/test/I2MoE-main/src/common/datasetsä¸­åŠ è½½å…¥æˆ‘çš„æ•°æ®é›†ï¼Œå…¶æ¨¡æ€æ˜¯HRFï¼ˆhsiï¼Œrgbï¼Œflourï¼‰ã€‚é¢„æµ‹ç»“æœæ˜¯å›å½’å¾—åˆ°æ•°å€¼ã€‚ç„¶åå†åœ¨train_transformer.pyä¸­åŠ è½½æˆ‘çš„æ•°æ®é›†ï¼Œç„¶ååœ¨/Users/schwertlilien/Downloads/test/I2MoE-main/scripts/train_scripts/imoe/transformerä¸­å†™å…¥è„šæœ¬ï¼Œæˆ‘æ˜¯å¦å°±èƒ½æˆåŠŸè¿è¡Œï¼Ÿé¦–å…ˆå‘Šè¯‰æˆ‘æˆ‘æƒ³è¦å¾—åˆ°ç»“æœâ€œç”¨I2MoEçš„æ–¹æ³•åœ¨æˆ‘çš„æ•°æ®é›†ä¸Šè®­ç»ƒå¾—åˆ°å›å½’æ•°å€¼çš„ç»“æœã€‚â€è¿™ä¸ªçš„æ­¥éª¤æ˜¯å¦æ­£ç¡®ï¼Œç„¶åæŒ‡å¯¼æˆ‘ä¸€æ­¥æ­¥çš„åšã€‚æˆ‘çš„æ•°æ®é›†çš„æ•°æ®å¤„ç†éƒ¨åˆ†ä½ å¯ä»¥å‚è€ƒ/Users/schwertlilien/Downloads/test/I2MoE-main/CBAM_model.pyï¼Œä»¥åŠ/Users/schwertlilien/Downloads/test/I2MoE-main/Fusion.pyï¼Œ/Users/schwertlilien/Downloads/test/I2MoE-main/src/common/datasets/mosi.pyä¸­çš„å†…å®¹ï¼Œå¹¶å‘ŠçŸ¥æˆ‘å¦‚ä½•ä¸€æ­¥æ­¥å®Œæˆæˆ‘çš„ç›®çš„ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå› ä¸ºæˆ‘çš„æ•°æ®æ˜¯ä¸‰æ¨¡æ€ï¼Œåšçš„å›å½’ä»»åŠ¡ï¼Œå› æ­¤æˆ‘è®¤ä¸ºä¹Ÿå¯ä»¥å€Ÿé‰´ï¼š/Users/schwertlilien/Downloads/test/I2MoE-main/src/common/datasets/mosi.pyä¸­çš„def load_and_preprocess_data_mosi_regression(args)</p>
<p>å†æ¬¡è®­ç»ƒäº†ä¸€ä¸‹ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ï¼š</p>
<p>ğŸ¯ WeightedFusion è®­ç»ƒå®Œæˆ!<br>â° æ€»ç”¨æ—¶: 1407.15 ç§’ (23.45 åˆ†é’Ÿ)<br>ğŸ“Š å¹³å‡æ¯è½®ç”¨æ—¶: 28.14 ç§’<br>âœ… WeightedFusion Results:<br>   MAE: 315382.7500, RÂ²: 0.2437, RMSE: 356854.2667</p>
<p>MODEL COMPARISON RESULTS</p>
<p>CBAMFusion      | MAE: 260728.6562 | RÂ²: 0.4745 | RMSE: 297479.2839<br>SimpleFusion    | MAE: 225593.0156 | RÂ²: 0.6269 | RMSE: 250650.9322<br>AttentionFusion | MAE: 184261.1094 | RÂ²: 0.7401 | RMSE: 209189.9109<br>WeightedFusion  | MAE: 315382.7500 | RÂ²: 0.2437 | RMSE: 356854.2667</p>
<p>I2MoEï¼š</p>
<p>Best model saved to ./saves/imoe/transformer/hrf_regression/seed_0_modality_HRF_train_epochs_100_val_loss_0.00.pth<br>Weight sum statistics: min=0.9999998807907104, max=1.0000001192092896<br>{â€˜modelâ€™: â€˜Interaction-MoE-Transformerâ€™, â€˜lrâ€™: 0.0001, â€˜temperature_rwâ€™: 1, â€˜hidden_dim_rwâ€™: 256, â€˜num_layer_rwâ€™: 1, â€˜interaction_loss_weightâ€™: 0.01, â€˜modalityâ€™: â€˜HRFâ€™, â€˜dataâ€™: â€˜hrf_regressionâ€™, â€˜gate_loss_weightâ€™: 0.01, â€˜train_epochsâ€™: 100, â€˜num_expertsâ€™: 16, â€˜num_layers_encâ€™: 1, â€˜num_layers_fusâ€™: 1, â€˜num_layers_predâ€™: 1, â€˜num_headsâ€™: 4, â€˜batch_sizeâ€™: 2, â€˜hidden_dimâ€™: 128, â€˜num_patchesâ€™: 16}<br>[Val] Average Loss: 0.0000 Â± 0.0000<br>[Test] Mean Absolute Error: 0.0045 Â± 0.0000</p>
<p>æ— è¯­äº†</p>
<p><img src="https://raw.githubusercontent.com/SchwertLin/Pic/main/imgimage-20251106114412890.png" alt="image-20251106114412890"></p>
<p>ä¸€äº›è®­ç»ƒç»“æœï¼šEpoch 57/100 | LR: 4.83e-05 | Train Loss: 0.0039 | Val Loss: 0.0004 | Val RÂ²: 0.8296 | Trigger: 11/15<br>Epoch 58/100: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:56&lt;00:00, 11.40s/it]<br>Epoch 58/100 | LR: 4.65e-05 | Train Loss: 0.0041 | Val Loss: 0.0005 | Val RÂ²: 0.7489 | Trigger: 12/15<br>Epoch 59/100: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:54&lt;00:00, 10.90s/it]<br>Epoch 59/100 | LR: 4.48e-05 | Train Loss: 0.0059 | Val Loss: 0.0005 | Val RÂ²: 0.7174 | Trigger: 13/15<br>Epoch 60/100: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:53&lt;00:00, 10.79s/it]<br>Epoch 60/100 | LR: 4.30e-05 | Train Loss: 0.0063 | Val Loss: 0.0004 | Val RÂ²: 0.8041 | Trigger: 14/15<br>Epoch 61/100: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:54&lt;00:00, 10.86s/it]<br>Early stopping triggered! No improvement for 15 consecutive epochs.</p>
<p>Training complete. Best model at epoch 46: RÂ²: 0.8705, Loss: 0.0003<br>Toxin min=2139.00931444048, Toxin max=9499122.31743333</p>
<p>â€”- Final Model Evaluation â€”-<br>Final performance on test set:<br>MAE (original scale): 123147.8203<br>RÂ² Score (original scale): 0.7876<br>Best model achieved RÂ²: 0.8705 at epoch 46</p>
<p>[Seed 0/2] [Epoch 99/100] Task Loss: 1.90, Router Loss: 0.00 / Val Loss: 1.90, Val MAE: 2.41</p>
<p>[Seed 0/2] [Epoch 100/100] Task Loss: 1.87, Router Loss: 0.00 / Val Loss: 1.87, Val MAE: 2.39</p>
<p>å†å†™ä¸€ä¸ªPPTçš„ï¼Œå¯¹ç»“æœè¿›è¡Œæ€»ç»“</p>
<p>CBAMåŸæ¨¡å‹ï¼š</p>
<p>Training complete. Best model at epoch 18: RÂ²: 0.6562, Loss: 0.0002<br>Toxin min=2057.80681921, Toxin max=15012381.5119922</p>
<p>â€”- Final Model Evaluation â€”-<br>Final performance on test set:<br>MAE (original scale): 116817.9766<br>RÂ² Score (original scale): 0.6562<br>Best model achieved RÂ²: 0.6562 at epoch 18</p>
<p>CBAM fusionï¼š144793.4844, RÂ²: 0.6314, RMSE: 245337.0193</p>
<p>SimpleFusionï¼š120648.1797, RÂ²: 0.6279, RMSE: 246501.0411</p>
<p>120648.1797, RÂ²: 0.6279, RMSE: 246501.0411</p>
<p>Attnï¼š125674.0234, RÂ²: 0.6734, RMSE: 230937.7103</p>
<p>MODEL COMPARISON RESULTS</p>
<p>CBAMFusion      | MAE: 104706.8516 | RÂ²: 0.6597 | RMSE: 235736.8306<br>SimpleFusion    | MAE: 154869.4531 | RÂ²: 0.6070 | RMSE: 253328.5654<br>AttentionFusion | MAE: 125674.0234 | RÂ²: 0.6734 | RMSE: 230937.7103<br>WeightedFusion  | MAE: 120461.5312 | RÂ²: 0.6496 | RMSE: 239227.2487</p>
<p>å­é›†æµ‹è¯•+æ¶ˆèå®éªŒâ€”&gt;å®šä½é—®é¢˜</p>
</div><div class="post-end"><div class="post-prev"><a href="/2025/11/10/2025-11-10/" title="ä¸Šä¸€ç¯‡æ–‡ç« "><i class="fa-solid fa-chevron-left fa-lg"></i></a></div><div class="post-next"><a href="/2025/10/17/2025-10-17/" title="ä¸‹ä¸€ç¯‡æ–‡ç« "><i class="fa-solid fa-chevron-right fa-lg"></i></a></div></div></article><div class="comment" id="comment"><script src="https://giscus.app/client.js" data-repo="SchwertLin/SwertLin_Blog_Comment" data-repo-id="R_kgDONXjrCQ" data-category="Announcements" data-category-id="DIC_kwDONXjrCc4Cky9X" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async="async"></script></div><div id="post-toc"><aside class="toc-aside"><div class="toc-title"><span><i class="fa-solid fa-paw"></i>ç›®å½•</span></div><div class="toc-container" id="toc-body"><ol class="toc-content"><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#%E5%AE%9E%E9%AA%8C%E8%AF%B4%E6%98%8E"><span class="toc-content-number">1.</span> <span class="toc-content-text">å®éªŒè¯´æ˜</span></a><ol class="toc-content-child"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E6%95%B0%E6%8D%AE"><span class="toc-content-number">1.1.</span> <span class="toc-content-text">æ•°æ®</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-content-number">1.2.</span> <span class="toc-content-text">æ•°æ®é¢„å¤„ç†</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E6%A8%A1%E5%9E%8B"><span class="toc-content-number">1.3.</span> <span class="toc-content-text">æ¨¡å‹</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E5%AE%9E%E9%AA%8C%E9%85%8D%E7%BD%AE"><span class="toc-content-number">1.4.</span> <span class="toc-content-text">å®éªŒé…ç½®</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-content-number">1.5.</span> <span class="toc-content-text">å®éªŒè¿è¡Œç»“æœ</span></a></li></ol></li></ol></div></aside><div class="toc-blank" onclick="tocToggle()"></div></div><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async="async"></script></div></div><div id="tool-bar"><div id="tool-bar-main"><div id="tool-toggle" onclick="toolToggle()" title="è®¾ç½®"><i class="fa-solid fa-gear"></i></div><div id="toc-toggle" onclick="tocToggle()" title="ç›®å½•"><i class="fa-solid fa-list-ul"></i></div><div id="go-to-comment" onclick="gotoComment()" title="è¯„è®º"><i class="fa-regular fa-message fa-flip-horizontal"></i></div><div id="back-to-top" onclick="scrollToTop()" title="è¿”å›é¡¶éƒ¨"><i class="fa-solid fa-chevron-up"></i></div></div><div id="tool-bar-more" style="display: none;"><div id="darkmode-switch" onclick="darkmodeSwitch()" title="æ·±è‰²æ¨¡å¼"><i class="fa-solid fa-circle-half-stroke"></i></div><div id="font-size-increase" onclick="fontSizeIncrease()" title="æ”¾å¤§å­—ä½“"><i class="fa-solid fa-plus"></i></div><div id="font-size-decrease" onclick="fontSizeDecrease()" title="ç¼©å°å­—ä½“"><i class="fa-solid fa-minus"></i></div></div></div><div id="search-panel"><div class="search-container"><div class="search-head"><div class="search-title"><span><i class="fa-solid fa-paw"></i>æœç´¢</span></div><div class="search-close-btn" onclick="toggleSearchWindow()"><i class="fa-regular fa-circle-xmark"></i></div></div><div class="search-box"><i class="fa-solid fa-magnifying-glass"></i><input id="search-input" type="text" placeholder="è¯·è¾“å…¥éœ€è¦æœç´¢çš„å†…å®¹â€¦â€¦" value=""/></div><div class="search-body"><div id="search-count">åŒ¹é…ç»“æœæ•°: </div><div id="search-result"></div><div id="search-result-empty">æœªæœç´¢åˆ°åŒ¹é…çš„æ–‡ç« ã€‚</div></div></div></div><footer><div class="footer-content"><div class="copyright-info"><i class="fa-regular fa-copyright fa-xs"></i><span>2022 - 2026 </span><a href="/about">Schwertlilien</a><i class="fa-solid fa-cat fa-sm"></i><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo</a><span> &amp; </span><a href="https://github.com/chanwj/hexo-theme-meow" target="_blank" title="v2.1.0">Theme Meow</a></div><div class="pageview-site"><span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡ : <span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner"></i></span></span><span id="busuanzi_container_site_uv">æ€»è®¿å®¢æ•° : <span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner"></i></span></span></div></div></footer>
<script>const GLOBAL_CONFIG = {
  comment: { theme: 'preferred_color_scheme'}
}
</script>
<script src="/js/third-party/darkmode.js"></script>
<script>var options = {
  dark: '/css/darkmode.css',
  startAt: '24:00',
  endAt: '06:00',
  checkSystemScheme: 'false',
  saveOnToggle: 'true'
};
var darkMode = new DarkMode(options);
// change comment theme synchronously åŒæ­¥ä¿®æ”¹è¯„è®ºåŒºä¸»é¢˜
if (darkMode.getMode() == "dark" && (true || true)) {
  if (document.getElementById('comment')) {
    document.getElementById('comment').getElementsByTagName('script')[0].setAttribute('data-theme', 'noborder_dark');
  }
}
</script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post-content').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/theme/tool-bar.js"></script>


<script src="/js/theme/menu.js"></script>


<script src="/js/third-party/clipboard.min.js"></script>


<script src="/js/theme/copy.js"></script>
<script>copyCode();
</script>
<script src="/js/jquery-3.7.1.min.js"></script>


<script src="/js/theme/search.js"></script>
<script>searchFunc('/search.xml', 'search-input', 'search-result');
</script></body></html>