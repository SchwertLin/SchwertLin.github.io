<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Schwertlilien"/><meta name="keyword"/><meta name="description" content="uv是什么？uv 是一个现代的 Python 包管理器和构建工具，由 Astral 公司开发（该公司还开发了知名的 ruff 代码检查工具），旨在提供比传统 pip 更快的依赖管理体验。 uv 可以理解为「增强版的 pip + venv + pip-tools」，核心功能包括：  依赖管理：安装、升级、卸载 Python 包（类似 pip），但速度极快（比 pip 快 10-100 倍）。 虚拟环">
<meta property="og:type" content="article">
<meta property="og:title" content="2025-8-18">
<meta property="og:url" content="http://example.com/2025/08/18/2025-8-18/index.html">
<meta property="og:site_name" content="Schwertlilien">
<meta property="og:description" content="uv是什么？uv 是一个现代的 Python 包管理器和构建工具，由 Astral 公司开发（该公司还开发了知名的 ruff 代码检查工具），旨在提供比传统 pip 更快的依赖管理体验。 uv 可以理解为「增强版的 pip + venv + pip-tools」，核心功能包括：  依赖管理：安装、升级、卸载 Python 包（类似 pip），但速度极快（比 pip 快 10-100 倍）。 虚拟环">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-08-18T06:27:41.000Z">
<meta property="article:modified_time" content="2025-08-18T15:26:01.000Z">
<meta property="article:author" content="Schwertlilien">
<meta property="article:tag" content="MCP">
<meta name="twitter:card" content="summary"><title>2025-8-18 - Schwertlilien - -----personal blog-----</title><link rel="shortcut icon" href="/img/site-icon.png">
<link rel="stylesheet" href="/css/style.css" id="dm-light">


<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
<meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="top-nav" ondblclick="scrollToTop()"><div class="nav-info"><div class="nav-icon"><img id="nav-icon" src="/img/site-icon.png"/></div><div class="nav-title"><a id="nav-title" href="/" title="主页">Schwertlilien</a></div></div><div class="nav-ribbon"><div class="top-menu-expanded"><a class="top-menu-item" href="/archives"><span>归档</span></a><a class="top-menu-item" href="/categories"><span>分类</span></a><a class="top-menu-item" href="/tags"><span>标签</span></a><a class="top-menu-item" href="/about"><span>关于</span></a></div><div class="top-search" onclick="toggleSearchWindow()"><div id="top-search-btn" title="搜索"><i class="icon fa-solid fa-magnifying-glass"></i><span>搜索</span></div></div><div id="top-menu-btn" onclick="openTopMenu()" title="打开菜单"><i class="fa-solid fa-bars fa-lg"></i></div></div></div></header><div id="top-menu-hidden"><div class="menu-hidden-content"><div class="menu-hidden-nav"><a class="menu-hidden-item" href="/archives"><i class="fa-solid fa-box-archive fa-sm"></i><span>归档</span></a><a class="menu-hidden-item" href="/categories"><i class="fa-regular fa-folder-open fa-sm"></i><span>分类</span></a><a class="menu-hidden-item" href="/tags"><i class="fa-solid fa-tags fa-sm"></i><span>标签</span></a><a class="menu-hidden-item" href="/about"><i class="fa-solid fa-paw fa-sm"></i><span>关于</span></a></div></div><div class="menu-hidden-blank" onclick="closeTopMenu()"></div></div>
<div class="blog-info"><div class="blog-pic"><img id="blog-pic" src="/img/site-icon.png"/></div><div class="blog-title"><i class="fa-solid fa-paw fa-2xs fa-rotate-by"></i><span>Schwertlilien</span><i class="fa-solid fa-paw fa-2xs fa-rotate-by"></i></div><div class="blog-desc">As a recoder: notes and ideas.</div></div><div class="main"><div class="main-content"><article class="post"><div class="post-title"><h1><i class="fa-solid fa-paw"></i>2025-8-18</h1></div><div class="post-info"><div class="post-info-first-line"><div class="post-date"><i class="icon fa-regular fa-calendar-plus" title="发布日期"></i><time class="publish-time">2025-08-18</time><i class="icon fa-regular fa-calendar-check" title="更新日期"></i><time class="update-time">2025-08-18</time></div>

<div class="post-tags"><i class="icon fa-solid fa-tags" title="标签"></i><a class="post-tag" href="/tags/MCP/">MCP</a></div></div><div class="post-info-second-line"><div class="post-copyright"><i class="icon fa-brands fa-creative-commons" title="版权声明"></i><span>版权声明: </span><a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh-hans" title="CC BY-NC-ND 4.0">署名-非商业性使用-禁止演绎 4.0</a></div>
<div class="post-word-count"><i class="icon fa-solid fa-pen-to-square"></i><span>全文约3.2K字</span></div><div class="pageview-post"><i class="icon fa-regular fa-eye"></i><span id="busuanzi_container_page_pv">阅读次数: <span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner"></i></span></span></div></div></div><div class="post-content"><h1 id="uv是什么？"><a href="#uv是什么？" class="headerlink" title="uv是什么？"></a>uv是什么？</h1><p><code>uv</code> 是一个现代的 Python 包管理器和构建工具，由 Astral 公司开发（该公司还开发了知名的 <code>ruff</code> 代码检查工具），旨在提供比传统 <code>pip</code> 更快的依赖管理体验。</p>
<p><code>uv</code> 可以理解为「增强版的 <code>pip + venv + pip-tools</code>」，核心功能包括：</p>
<ol>
<li><strong>依赖管理</strong>：安装、升级、卸载 Python 包（类似 <code>pip</code>），但速度极快（比 <code>pip</code> 快 10-100 倍）。</li>
<li><strong>虚拟环境管理</strong>：创建、激活虚拟环境（类似 <code>python -m venv</code>），命令更简洁（<code>uv venv</code> 替代 <code>python -m venv .venv</code>）。</li>
<li><strong>项目初始化</strong>：通过 <code>uv init</code> 创建标准化的 Python 项目结构（生成 <code>pyproject.toml</code> 等配置文件）。</li>
<li><strong>依赖锁定</strong>：自动生成 <code>uv.lock</code> 文件，精确记录依赖版本，确保环境一致性（类似 <code>pip freeze</code> 但更高效）。</li>
</ol>
<p>简单说，<code>uv</code> 是一个「一站式工具」，用统一的命令解决 Python 项目的环境管理和依赖安装问题，主打<strong>速度快、体验统一</strong>。</p>
<h1 id="uv为什么能-要创造虚拟环境？"><a href="#uv为什么能-要创造虚拟环境？" class="headerlink" title="uv为什么能/要创造虚拟环境？"></a>uv为什么能/要创造虚拟环境？</h1><p>虚拟环境是 Python 开发的基础需求（隔离不同项目的依赖），传统上需要用 <code>python -m venv</code> 或第三方工具（如 <code>virtualenv</code>）。<br><code>uv</code> 内置了虚拟环境功能，原因是：</p>
<ul>
<li>简化工作流：无需记住 <code>python -m venv</code> 这种冗长命令，用 <code>uv venv</code> 即可一键创建，与依赖管理命令（<code>uv add</code>）无缝衔接。</li>
<li>提升效率：<code>uv</code> 的虚拟环境创建速度比 <code>python -m venv</code> 更快，且默认配置更合理（如自动使用当前 Python 版本）。</li>
</ul>
<p>本质上，<code>uv</code> 创建的虚拟环境与 <code>python -m venv</code> 完全兼容，只是操作更简便。</p>
<h1 id="与Conda的区别？"><a href="#与Conda的区别？" class="headerlink" title="与Conda的区别？"></a>与Conda的区别？</h1><p>和 <code>conda</code> 相比，<code>uv</code> 更轻量、更专注 Python，而 <code>conda</code> 适合复杂的跨语言环境。uv创建虚拟环境是为了简化工作流，与传统 <code>venv</code> 兼容；集「虚拟环境 + 依赖管理」于一身。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>维度</th>
<th><code>uv</code></th>
<th><code>conda</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>定位</strong></td>
<td>专注于 Python 包和虚拟环境管理</td>
<td>跨语言的包管理器（支持 Python、C++ 等）+ 环境管理工具</td>
</tr>
<tr>
<td><strong>依赖来源</strong></td>
<td>仅从 PyPI 安装 Python 包</td>
<td>从 Anaconda 仓库安装，支持非 Python 包（如 C 库、CUDA 等）</td>
</tr>
<tr>
<td><strong>环境隔离级别</strong></td>
<td>基于 Python 解释器的轻量级隔离</td>
<td>全环境隔离（包括系统级依赖），隔离更彻底但体积更大</td>
</tr>
<tr>
<td><strong>速度</strong></td>
<td>极快（用 Rust 编写，优化了依赖解析）</td>
<td>相对较慢（尤其解决依赖冲突时）</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>纯 Python 项目、快速迭代的开发场景</td>
<td>多语言项目、需要系统级依赖（如数据科学、机器学习）</td>
</tr>
<tr>
<td><strong>配置复杂度</strong></td>
<td>简单（依赖 <code>pyproject.toml</code> 标准配置）</td>
<td>较复杂（有自己的配置体系和频道概念）</td>
</tr>
</tbody>
</table>
</div>
<h1 id="uvx？"><a href="#uvx？" class="headerlink" title="uvx？"></a>uvx？</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uvx black --check my_script.py</span><br></pre></td></tr></table></figure>
<p><code>uvx</code> 会自动下载 <code>black</code> 到临时目录，执行命令后不会残留依赖，不污染当前项目环境。<code>uvx</code> 是 <code>uv</code> 工具集中的一个子命令，专门用于<strong>临时运行 Python 包中的可执行程序，而无需手动安装包到当前环境</strong>。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>方式</th>
<th>特点</th>
<th>适用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uv add &lt;package&gt;</code></td>
<td>安装包到当前环境，长期可用</td>
<td>项目核心依赖、需要反复使用的工具</td>
</tr>
<tr>
<td><code>uvx &lt;package&gt;</code></td>
<td>临时下载并运行，不安装到环境</td>
<td>一次性使用、试用工具、避免污染环境</td>
</tr>
</tbody>
</table>
</div>
<h2 id="uvx典型使用场景"><a href="#uvx典型使用场景" class="headerlink" title="uvx典型使用场景"></a>uvx典型使用场景</h2><ol>
<li><strong>试用工具</strong>：快速验证某个包的功能，比如用 <code>uvx pip-audit</code> 临时检查项目依赖的安全漏洞，用完即走。</li>
<li><strong>避免环境污染</strong>：对于偶尔使用的工具（如 <code>pyright</code> 类型检查、<code>pdoc</code> 文档生成），不需要长期安装在项目依赖中，用 <code>uvx</code> 临时调用更干净。</li>
<li><strong>指定版本运行</strong>：可以通过 <code>uvx &lt;package&gt;==&lt;version&gt;</code> 强制使用特定版本，例如 <code>uvx black==23.1.0</code> 确保用旧版本格式化代码。</li>
<li><strong>运行脚本</strong>：甚至可以直接执行远程脚本，例如 <code>uvx https://example.com/script.py</code>（会自动处理依赖）。</li>
</ol>
<h1 id="My-MCP-Server"><a href="#My-MCP-Server" class="headerlink" title="My MCP Server"></a>My MCP Server</h1><h2 id="方案一：同一个-Server-下的多个-Tools"><a href="#方案一：同一个-Server-下的多个-Tools" class="headerlink" title="方案一：同一个 Server 下的多个 Tools"></a>方案一：同一个 Server 下的多个 Tools</h2><p><strong>适合场景</strong>：想做一个完整的视频处理流水线（下载 → 分离音频 → 语音转写），放在同一个 server。</p>
<ul>
<li><strong>做法</strong>：把 <code>download_video</code>、<code>split_video_audio</code>、<code>transcribe_audio</code> 都放在一个 MCP server 里，用同一个 <code>FastMCP(&quot;video_pipeline&quot;)</code> 实例。</li>
<li><strong>优点</strong>：<ul>
<li>使用方便：只需要启动一个 server，所有功能都能调用；</li>
<li>工具之间的数据流（下载 → 分离 → 转写）更连贯；</li>
<li>管理简单，部署维护成本低。</li>
</ul>
</li>
<li><strong>缺点</strong>：<ul>
<li>如果某个功能出问题（例如 Whisper 模型加载太慢），可能影响整个 server 的可用性；</li>
<li>Server 会比较“臃肿”。</li>
</ul>
</li>
</ul>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">McpServer</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@modelcontextprotocol/sdk/server/mcp.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">StdioServerTransport</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@modelcontextprotocol/sdk/server/stdio.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; z &#125; <span class="keyword">from</span> <span class="string">&quot;zod&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; exec, <span class="title class_">ExecOptions</span> <span class="keyword">as</span> <span class="title class_">ChildProcessExecOptions</span> &#125; <span class="keyword">from</span> <span class="string">&quot;child_process&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; promisify &#125; <span class="keyword">from</span> <span class="string">&quot;util&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&quot;fs/promises&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> os <span class="keyword">from</span> <span class="string">&quot;node:os&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> notifier <span class="keyword">from</span> <span class="string">&quot;node-notifier&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> execAsync = <span class="title function_">promisify</span>(exec);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create an MCP server</span></span><br><span class="line"><span class="keyword">const</span> server = <span class="keyword">new</span> <span class="title class_">McpServer</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;FFmpegProcessor&quot;</span>,</span><br><span class="line">  <span class="attr">version</span>: <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define available resolutions</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">RESOLUTIONS</span> = &#123;</span><br><span class="line">  <span class="string">&quot;360p&quot;</span>: &#123; <span class="attr">width</span>: <span class="number">640</span>, <span class="attr">height</span>: <span class="number">360</span> &#125;,</span><br><span class="line">  <span class="string">&quot;480p&quot;</span>: &#123; <span class="attr">width</span>: <span class="number">854</span>, <span class="attr">height</span>: <span class="number">480</span> &#125;,</span><br><span class="line">  <span class="string">&quot;720p&quot;</span>: &#123; <span class="attr">width</span>: <span class="number">1280</span>, <span class="attr">height</span>: <span class="number">720</span> &#125;,</span><br><span class="line">  <span class="string">&quot;1080p&quot;</span>: &#123; <span class="attr">width</span>: <span class="number">1920</span>, <span class="attr">height</span>: <span class="number">1080</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Helper function to ask for permission using node-notifier</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">askPermission</span>(<span class="params"><span class="attr">action</span>: <span class="built_in">string</span></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">boolean</span>&gt; &#123;</span><br><span class="line">  <span class="comment">// Skip notification if DISABLE_NOTIFICATIONS is set</span></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">DISABLE_NOTIFICATIONS</span> === <span class="string">&#x27;true&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Auto-allowing action (notifications disabled): <span class="subst">$&#123;action&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    notifier.<span class="title function_">notify</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;FFmpeg Processor Permission Request&#x27;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">`<span class="subst">$&#123;action&#125;</span>`</span>,</span><br><span class="line">      <span class="attr">wait</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">timeout</span>: <span class="number">60</span>,</span><br><span class="line">      <span class="attr">actions</span>: <span class="string">&#x27;Allow&#x27;</span>,</span><br><span class="line">      <span class="attr">closeLabel</span>: <span class="string">&#x27;Deny&#x27;</span></span><br><span class="line">    &#125;, <span class="function">(<span class="params">err, response, metadata</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error showing notification:&#x27;</span>, err);</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> buttonPressed = metadata?.<span class="property">activationValue</span> || response;</span><br><span class="line">      <span class="title function_">resolve</span>(buttonPressed !== <span class="string">&#x27;Deny&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Helper function to ensure output directories exist</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">ensureDirectoriesExist</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> outputDir = path.<span class="title function_">join</span>(os.<span class="title function_">tmpdir</span>(), <span class="string">&#x27;ffmpeg-output&#x27;</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> fs.<span class="title function_">mkdir</span>(outputDir, &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> outputDir;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating output directory:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> os.<span class="title function_">tmpdir</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tool to check FFmpeg version</span></span><br><span class="line">server.<span class="title function_">tool</span>(</span><br><span class="line">  <span class="string">&quot;get-ffmpeg-version&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Get the version of FFmpeg installed on the system&quot;</span>,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; stdout, stderr &#125; = <span class="keyword">await</span> <span class="title function_">execAsync</span>(<span class="string">&#x27;ffmpeg -version&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Extract the version from the output</span></span><br><span class="line">      <span class="keyword">const</span> versionMatch = stdout.<span class="title function_">match</span>(<span class="regexp">/ffmpeg version (\S+)/</span>);</span><br><span class="line">      <span class="keyword">const</span> version = versionMatch ? versionMatch[<span class="number">1</span>] : <span class="string">&#x27;Unknown&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`FFmpeg Version: <span class="subst">$&#123;version&#125;</span>\n\nFull version info:\n<span class="subst">$&#123;stdout&#125;</span>`</span></span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`Error getting FFmpeg version: <span class="subst">$&#123;errorMessage&#125;</span>\n\nMake sure FFmpeg is installed and in your PATH.`</span></span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tool to resize video</span></span><br><span class="line">server.<span class="title function_">tool</span>(</span><br><span class="line">  <span class="string">&quot;resize-video&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Resize a video to one or more standard resolutions&quot;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">videoPath</span>: z.<span class="title function_">string</span>().<span class="title function_">describe</span>(<span class="string">&quot;Path to the video file to resize&quot;</span>),</span><br><span class="line">    <span class="attr">resolutions</span>: z.<span class="title function_">array</span>(z.<span class="title function_">enum</span>([<span class="string">&quot;360p&quot;</span>, <span class="string">&quot;480p&quot;</span>, <span class="string">&quot;720p&quot;</span>, <span class="string">&quot;1080p&quot;</span>])).<span class="title function_">describe</span>(<span class="string">&quot;Resolutions to convert the video to&quot;</span>),</span><br><span class="line">    <span class="attr">outputDir</span>: z.<span class="title function_">string</span>().<span class="title function_">optional</span>().<span class="title function_">describe</span>(<span class="string">&quot;Optional directory to save the output files (defaults to a temporary directory)&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">async</span> (&#123; videoPath, resolutions, outputDir &#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Resolve the absolute path</span></span><br><span class="line">      <span class="keyword">const</span> absVideoPath = path.<span class="title function_">resolve</span>(videoPath);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check if file exists</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.<span class="title function_">access</span>(absVideoPath);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error: Video file not found at <span class="subst">$&#123;absVideoPath&#125;</span>`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Determine output directory</span></span><br><span class="line">      <span class="keyword">let</span> outputDirectory = outputDir ? path.<span class="title function_">resolve</span>(outputDir) : <span class="keyword">await</span> <span class="title function_">ensureDirectoriesExist</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check if output directory exists and is writable</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.<span class="title function_">access</span>(outputDirectory, fs.<span class="property">constants</span>.<span class="property">W_OK</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error: Output directory <span class="subst">$&#123;outputDirectory&#125;</span> does not exist or is not writable`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format command for permission request</span></span><br><span class="line">      <span class="keyword">const</span> resolutionsStr = resolutions.<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> permissionMessage = <span class="string">`Resize video <span class="subst">$&#123;path.basename(absVideoPath)&#125;</span> to <span class="subst">$&#123;resolutionsStr&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Ask for permission</span></span><br><span class="line">      <span class="keyword">const</span> permitted = <span class="keyword">await</span> <span class="title function_">askPermission</span>(permissionMessage);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!permitted) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&quot;Permission denied by user&quot;</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Get video filename without extension</span></span><br><span class="line">      <span class="keyword">const</span> videoFilename = path.<span class="title function_">basename</span>(absVideoPath, path.<span class="title function_">extname</span>(absVideoPath));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Define the type for our results</span></span><br><span class="line">      <span class="keyword">type</span> <span class="title class_">ResizeResult</span> = &#123;</span><br><span class="line">        <span class="attr">resolution</span>: <span class="string">&quot;360p&quot;</span> | <span class="string">&quot;480p&quot;</span> | <span class="string">&quot;720p&quot;</span> | <span class="string">&quot;1080p&quot;</span>;</span><br><span class="line">        <span class="attr">outputPath</span>: <span class="built_in">string</span>;</span><br><span class="line">        <span class="attr">success</span>: <span class="built_in">boolean</span>;</span><br><span class="line">        <span class="attr">error</span>?: <span class="built_in">string</span>;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Process each resolution</span></span><br><span class="line">      <span class="keyword">const</span> <span class="attr">results</span>: <span class="title class_">ResizeResult</span>[] = [];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> resolution <span class="keyword">of</span> resolutions) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; width, height &#125; = <span class="variable constant_">RESOLUTIONS</span>[resolution <span class="keyword">as</span> keyof <span class="keyword">typeof</span> <span class="variable constant_">RESOLUTIONS</span>];</span><br><span class="line">        <span class="keyword">const</span> outputFilename = <span class="string">`<span class="subst">$&#123;videoFilename&#125;</span>_<span class="subst">$&#123;resolution&#125;</span><span class="subst">$&#123;path.extname(absVideoPath)&#125;</span>`</span>;</span><br><span class="line">        <span class="keyword">const</span> outputPath = path.<span class="title function_">join</span>(outputDirectory, outputFilename);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Build FFmpeg command</span></span><br><span class="line">        <span class="keyword">const</span> command = <span class="string">`ffmpeg -i &quot;<span class="subst">$&#123;absVideoPath&#125;</span>&quot; -vf &quot;scale=<span class="subst">$&#123;width&#125;</span>:<span class="subst">$&#123;height&#125;</span>&quot; -c:v libx264 -crf 23 -preset medium -c:a aac -b:a 128k &quot;<span class="subst">$&#123;outputPath&#125;</span>&quot;`</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">// Execute FFmpeg command</span></span><br><span class="line">          <span class="keyword">const</span> &#123; stdout, stderr &#125; = <span class="keyword">await</span> <span class="title function_">execAsync</span>(command);</span><br><span class="line"></span><br><span class="line">          results.<span class="title function_">push</span>(&#123;</span><br><span class="line">            resolution,</span><br><span class="line">            outputPath,</span><br><span class="line">            <span class="attr">success</span>: <span class="literal">true</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line"></span><br><span class="line">          results.<span class="title function_">push</span>(&#123;</span><br><span class="line">            resolution,</span><br><span class="line">            outputPath,</span><br><span class="line">            <span class="attr">success</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">error</span>: errorMessage</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format results</span></span><br><span class="line">      <span class="keyword">const</span> successCount = results.<span class="title function_">filter</span>(<span class="function"><span class="params">r</span> =&gt;</span> r.<span class="property">success</span>).<span class="property">length</span>;</span><br><span class="line">      <span class="keyword">const</span> failCount = results.<span class="property">length</span> - successCount;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> resultText = <span class="string">`Processed <span class="subst">$&#123;results.length&#125;</span> resolutions (<span class="subst">$&#123;successCount&#125;</span> successful, <span class="subst">$&#123;failCount&#125;</span> failed)\n\n`</span>;</span><br><span class="line"></span><br><span class="line">      results.<span class="title function_">forEach</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">success</span>) &#123;</span><br><span class="line">          resultText += <span class="string">`✅ <span class="subst">$&#123;result.resolution&#125;</span>: <span class="subst">$&#123;result.outputPath&#125;</span>\n`</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          resultText += <span class="string">`❌ <span class="subst">$&#123;result.resolution&#125;</span>: Failed - <span class="subst">$&#123;result.error&#125;</span>\n`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: resultText</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`Error resizing video: <span class="subst">$&#123;errorMessage&#125;</span>`</span></span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tool to extract audio from video</span></span><br><span class="line">server.<span class="title function_">tool</span>(</span><br><span class="line">  <span class="string">&quot;extract-audio&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Extract audio from a video file&quot;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">videoPath</span>: z.<span class="title function_">string</span>().<span class="title function_">describe</span>(<span class="string">&quot;Path to the video file to extract audio from&quot;</span>),</span><br><span class="line">    <span class="attr">format</span>: z.<span class="title function_">enum</span>([<span class="string">&quot;mp3&quot;</span>, <span class="string">&quot;aac&quot;</span>, <span class="string">&quot;wav&quot;</span>, <span class="string">&quot;ogg&quot;</span>]).<span class="title function_">default</span>(<span class="string">&quot;mp3&quot;</span>).<span class="title function_">describe</span>(<span class="string">&quot;Audio format to extract&quot;</span>),</span><br><span class="line">    <span class="attr">outputDir</span>: z.<span class="title function_">string</span>().<span class="title function_">optional</span>().<span class="title function_">describe</span>(<span class="string">&quot;Optional directory to save the output file (defaults to a temporary directory)&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">async</span> (&#123; videoPath, format, outputDir &#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Resolve the absolute path</span></span><br><span class="line">      <span class="keyword">const</span> absVideoPath = path.<span class="title function_">resolve</span>(videoPath);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check if file exists</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.<span class="title function_">access</span>(absVideoPath);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error: Video file not found at <span class="subst">$&#123;absVideoPath&#125;</span>`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Determine output directory</span></span><br><span class="line">      <span class="keyword">let</span> outputDirectory = outputDir ? path.<span class="title function_">resolve</span>(outputDir) : <span class="keyword">await</span> <span class="title function_">ensureDirectoriesExist</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check if output directory exists and is writable</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.<span class="title function_">access</span>(outputDirectory, fs.<span class="property">constants</span>.<span class="property">W_OK</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error: Output directory <span class="subst">$&#123;outputDirectory&#125;</span> does not exist or is not writable`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format command for permission request</span></span><br><span class="line">      <span class="keyword">const</span> permissionMessage = <span class="string">`Extract <span class="subst">$&#123;format&#125;</span> audio from video <span class="subst">$&#123;path.basename(absVideoPath)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Ask for permission</span></span><br><span class="line">      <span class="keyword">const</span> permitted = <span class="keyword">await</span> <span class="title function_">askPermission</span>(permissionMessage);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!permitted) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&quot;Permission denied by user&quot;</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Get video filename without extension</span></span><br><span class="line">      <span class="keyword">const</span> videoFilename = path.<span class="title function_">basename</span>(absVideoPath, path.<span class="title function_">extname</span>(absVideoPath));</span><br><span class="line">      <span class="keyword">const</span> outputFilename = <span class="string">`<span class="subst">$&#123;videoFilename&#125;</span>.<span class="subst">$&#123;format&#125;</span>`</span>;</span><br><span class="line">      <span class="keyword">const</span> outputPath = path.<span class="title function_">join</span>(outputDirectory, outputFilename);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Determine audio codec based on format</span></span><br><span class="line">      <span class="keyword">let</span> audioCodec;</span><br><span class="line">      <span class="keyword">switch</span> (format) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;mp3&#x27;</span>:</span><br><span class="line">          audioCodec = <span class="string">&#x27;libmp3lame&#x27;</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;aac&#x27;</span>:</span><br><span class="line">          audioCodec = <span class="string">&#x27;aac&#x27;</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;wav&#x27;</span>:</span><br><span class="line">          audioCodec = <span class="string">&#x27;pcm_s16le&#x27;</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ogg&#x27;</span>:</span><br><span class="line">          audioCodec = <span class="string">&#x27;libvorbis&#x27;</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">          audioCodec = <span class="string">&#x27;libmp3lame&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Build FFmpeg command</span></span><br><span class="line">      <span class="keyword">const</span> command = <span class="string">`ffmpeg -i &quot;<span class="subst">$&#123;absVideoPath&#125;</span>&quot; -vn -acodec <span class="subst">$&#123;audioCodec&#125;</span> &quot;<span class="subst">$&#123;outputPath&#125;</span>&quot;`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// Execute FFmpeg command</span></span><br><span class="line">        <span class="keyword">const</span> &#123; stdout, stderr &#125; = <span class="keyword">await</span> <span class="title function_">execAsync</span>(command);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Successfully extracted audio to: <span class="subst">$&#123;outputPath&#125;</span>`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error extracting audio: <span class="subst">$&#123;errorMessage&#125;</span>`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`Error extracting audio: <span class="subst">$&#123;errorMessage&#125;</span>`</span></span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tool to get video information</span></span><br><span class="line">server.<span class="title function_">tool</span>(</span><br><span class="line">  <span class="string">&quot;get-video-info&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Get detailed information about a video file&quot;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">videoPath</span>: z.<span class="title function_">string</span>().<span class="title function_">describe</span>(<span class="string">&quot;Path to the video file to analyze&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">async</span> (&#123; videoPath &#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Resolve the absolute path</span></span><br><span class="line">      <span class="keyword">const</span> absVideoPath = path.<span class="title function_">resolve</span>(videoPath);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check if file exists</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> fs.<span class="title function_">access</span>(absVideoPath);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">`Error: Video file not found at <span class="subst">$&#123;absVideoPath&#125;</span>`</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format command for permission request</span></span><br><span class="line">      <span class="keyword">const</span> permissionMessage = <span class="string">`Analyze video file <span class="subst">$&#123;path.basename(absVideoPath)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Ask for permission</span></span><br><span class="line">      <span class="keyword">const</span> permitted = <span class="keyword">await</span> <span class="title function_">askPermission</span>(permissionMessage);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!permitted) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">content</span>: [&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&quot;Permission denied by user&quot;</span></span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Build FFprobe command to get video information in JSON format</span></span><br><span class="line">      <span class="keyword">const</span> command = <span class="string">`ffprobe -v quiet -print_format json -show_format -show_streams &quot;<span class="subst">$&#123;absVideoPath&#125;</span>&quot;`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Execute FFprobe command</span></span><br><span class="line">      <span class="keyword">const</span> &#123; stdout, stderr &#125; = <span class="keyword">await</span> <span class="title function_">execAsync</span>(command);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Parse the JSON output</span></span><br><span class="line">      <span class="keyword">const</span> videoInfo = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(stdout);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format the output in a readable way</span></span><br><span class="line">      <span class="keyword">let</span> formattedInfo = <span class="string">`Video Information for: <span class="subst">$&#123;path.basename(absVideoPath)&#125;</span>\n\n`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Format information</span></span><br><span class="line">      <span class="keyword">if</span> (videoInfo.<span class="property">format</span>) &#123;</span><br><span class="line">        formattedInfo += <span class="string">`Format: <span class="subst">$&#123;videoInfo.format.format_name&#125;</span>\n`</span>;</span><br><span class="line">        formattedInfo += <span class="string">`Duration: <span class="subst">$&#123;videoInfo.format.duration&#125;</span> seconds\n`</span>;</span><br><span class="line">        formattedInfo += <span class="string">`Size: <span class="subst">$&#123;(<span class="built_in">parseInt</span>(videoInfo.format.size) / (<span class="number">1024</span> * <span class="number">1024</span>)).toFixed(<span class="number">2</span>)&#125;</span> MB\n`</span>;</span><br><span class="line">        formattedInfo += <span class="string">`Bitrate: <span class="subst">$&#123;(<span class="built_in">parseInt</span>(videoInfo.format.bit_rate) / <span class="number">1000</span>).toFixed(<span class="number">2</span>)&#125;</span> kbps\n\n`</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Stream information</span></span><br><span class="line">      <span class="keyword">if</span> (videoInfo.<span class="property">streams</span> &amp;&amp; videoInfo.<span class="property">streams</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        formattedInfo += <span class="string">`Streams:\n`</span>;</span><br><span class="line"></span><br><span class="line">        videoInfo.<span class="property">streams</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params"><span class="attr">stream</span>: <span class="built_in">any</span>, <span class="attr">index</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">          formattedInfo += <span class="string">`\nStream #<span class="subst">$&#123;index&#125;</span> (<span class="subst">$&#123;stream.codec_type&#125;</span>):\n`</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (stream.<span class="property">codec_type</span> === <span class="string">&#x27;video&#x27;</span>) &#123;</span><br><span class="line">            formattedInfo += <span class="string">`  Codec: <span class="subst">$&#123;stream.codec_name&#125;</span>\n`</span>;</span><br><span class="line">            formattedInfo += <span class="string">`  Resolution: <span class="subst">$&#123;stream.width&#125;</span>x<span class="subst">$&#123;stream.height&#125;</span>\n`</span>;</span><br><span class="line">            formattedInfo += <span class="string">`  Frame rate: <span class="subst">$&#123;stream.r_frame_rate&#125;</span>\n`</span>;</span><br><span class="line">            <span class="keyword">if</span> (stream.<span class="property">bit_rate</span>) &#123;</span><br><span class="line">              formattedInfo += <span class="string">`  Bitrate: <span class="subst">$&#123;(<span class="built_in">parseInt</span>(stream.bit_rate) / <span class="number">1000</span>).toFixed(<span class="number">2</span>)&#125;</span> kbps\n`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (stream.<span class="property">codec_type</span> === <span class="string">&#x27;audio&#x27;</span>) &#123;</span><br><span class="line">            formattedInfo += <span class="string">`  Codec: <span class="subst">$&#123;stream.codec_name&#125;</span>\n`</span>;</span><br><span class="line">            formattedInfo += <span class="string">`  Sample rate: <span class="subst">$&#123;stream.sample_rate&#125;</span> Hz\n`</span>;</span><br><span class="line">            formattedInfo += <span class="string">`  Channels: <span class="subst">$&#123;stream.channels&#125;</span>\n`</span>;</span><br><span class="line">            <span class="keyword">if</span> (stream.<span class="property">bit_rate</span>) &#123;</span><br><span class="line">              formattedInfo += <span class="string">`  Bitrate: <span class="subst">$&#123;(<span class="built_in">parseInt</span>(stream.bit_rate) / <span class="number">1000</span>).toFixed(<span class="number">2</span>)&#125;</span> kbps\n`</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: formattedInfo</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">const</span> errorMessage = error <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? error.<span class="property">message</span> : <span class="title class_">String</span>(error);</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">isError</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">content</span>: [&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;text&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">          <span class="attr">text</span>: <span class="string">`Error getting video information: <span class="subst">$&#123;errorMessage&#125;</span>`</span></span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start the server</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> transport = <span class="keyword">new</span> <span class="title class_">StdioServerTransport</span>();</span><br><span class="line">    <span class="keyword">await</span> server.<span class="title function_">connect</span>(transport);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;FFmpeg MCP Server running&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error starting server:&quot;</span>, error);</span><br><span class="line">    process.<span class="title function_">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure>
</div><div class="post-end"><div class="post-prev"><a href="/2025/08/19/2025-8-19/" title="上一篇文章"><i class="fa-solid fa-chevron-left fa-lg"></i></a></div><div class="post-next"><a href="/2025/08/16/2025-8-16/" title="下一篇文章"><i class="fa-solid fa-chevron-right fa-lg"></i></a></div></div></article><div class="comment" id="comment"><script src="https://giscus.app/client.js" data-repo="SchwertLin/SwertLin_Blog_Comment" data-repo-id="R_kgDONXjrCQ" data-category="Announcements" data-category-id="DIC_kwDONXjrCc4Cky9X" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async="async"></script></div><div id="post-toc"><aside class="toc-aside"><div class="toc-title"><span><i class="fa-solid fa-paw"></i>目录</span></div><div class="toc-container" id="toc-body"><ol class="toc-content"><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#uv%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-content-number">1.</span> <span class="toc-content-text">uv是什么？</span></a></li><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#uv%E4%B8%BA%E4%BB%80%E4%B9%88%E8%83%BD-%E8%A6%81%E5%88%9B%E9%80%A0%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%EF%BC%9F"><span class="toc-content-number">2.</span> <span class="toc-content-text">uv为什么能&#x2F;要创造虚拟环境？</span></a></li><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#%E4%B8%8EConda%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-content-number">3.</span> <span class="toc-content-text">与Conda的区别？</span></a></li><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#uvx%EF%BC%9F"><span class="toc-content-number">4.</span> <span class="toc-content-text">uvx？</span></a><ol class="toc-content-child"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#uvx%E5%85%B8%E5%9E%8B%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-content-number">4.1.</span> <span class="toc-content-text">uvx典型使用场景</span></a></li></ol></li><li class="toc-content-item toc-content-level-1"><a class="toc-content-link" href="#My-MCP-Server"><span class="toc-content-number">5.</span> <span class="toc-content-text">My MCP Server</span></a><ol class="toc-content-child"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9A%E5%90%8C%E4%B8%80%E4%B8%AA-Server-%E4%B8%8B%E7%9A%84%E5%A4%9A%E4%B8%AA-Tools"><span class="toc-content-number">5.1.</span> <span class="toc-content-text">方案一：同一个 Server 下的多个 Tools</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-content-number">5.2.</span> <span class="toc-content-text">代码</span></a></li></ol></li></ol></div></aside><div class="toc-blank" onclick="tocToggle()"></div></div><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async="async"></script></div></div><div id="tool-bar"><div id="tool-bar-main"><div id="tool-toggle" onclick="toolToggle()" title="设置"><i class="fa-solid fa-gear"></i></div><div id="toc-toggle" onclick="tocToggle()" title="目录"><i class="fa-solid fa-list-ul"></i></div><div id="go-to-comment" onclick="gotoComment()" title="评论"><i class="fa-regular fa-message fa-flip-horizontal"></i></div><div id="back-to-top" onclick="scrollToTop()" title="返回顶部"><i class="fa-solid fa-chevron-up"></i></div></div><div id="tool-bar-more" style="display: none;"><div id="darkmode-switch" onclick="darkmodeSwitch()" title="深色模式"><i class="fa-solid fa-circle-half-stroke"></i></div><div id="font-size-increase" onclick="fontSizeIncrease()" title="放大字体"><i class="fa-solid fa-plus"></i></div><div id="font-size-decrease" onclick="fontSizeDecrease()" title="缩小字体"><i class="fa-solid fa-minus"></i></div></div></div><div id="search-panel"><div class="search-container"><div class="search-head"><div class="search-title"><span><i class="fa-solid fa-paw"></i>搜索</span></div><div class="search-close-btn" onclick="toggleSearchWindow()"><i class="fa-regular fa-circle-xmark"></i></div></div><div class="search-box"><i class="fa-solid fa-magnifying-glass"></i><input id="search-input" type="text" placeholder="请输入需要搜索的内容……" value=""/></div><div class="search-body"><div id="search-count">匹配结果数: </div><div id="search-result"></div><div id="search-result-empty">未搜索到匹配的文章。</div></div></div></div><footer><div class="footer-content"><div class="copyright-info"><i class="fa-regular fa-copyright fa-xs"></i><span>2022 - 2026 </span><a href="/about">Schwertlilien</a><i class="fa-solid fa-cat fa-sm"></i><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo</a><span> &amp; </span><a href="https://github.com/chanwj/hexo-theme-meow" target="_blank" title="v2.1.0">Theme Meow</a></div><div class="pageview-site"><span id="busuanzi_container_site_pv">总访问量 : <span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner"></i></span></span><span id="busuanzi_container_site_uv">总访客数 : <span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner"></i></span></span></div></div></footer>
<script>const GLOBAL_CONFIG = {
  comment: { theme: 'preferred_color_scheme'}
}
</script>
<script src="/js/third-party/darkmode.js"></script>
<script>var options = {
  dark: '/css/darkmode.css',
  startAt: '24:00',
  endAt: '06:00',
  checkSystemScheme: 'false',
  saveOnToggle: 'true'
};
var darkMode = new DarkMode(options);
// change comment theme synchronously 同步修改评论区主题
if (darkMode.getMode() == "dark" && (true || true)) {
  if (document.getElementById('comment')) {
    document.getElementById('comment').getElementsByTagName('script')[0].setAttribute('data-theme', 'noborder_dark');
  }
}
</script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post-content').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/theme/tool-bar.js"></script>


<script src="/js/theme/menu.js"></script>


<script src="/js/third-party/clipboard.min.js"></script>


<script src="/js/theme/copy.js"></script>
<script>copyCode();
</script>
<script src="/js/jquery-3.7.1.min.js"></script>


<script src="/js/theme/search.js"></script>
<script>searchFunc('/search.xml', 'search-input', 'search-result');
</script></body></html>